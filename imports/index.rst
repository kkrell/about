Imports and exports
===================

.. note::
    
    Attention: the import procedure is about to change in the next version of
    DDI on Rails.

New import design (DDI on Rails 2)
----------------------------------

The new imports are closely tied to the data model. Many "additional
functionality" was removed, e.g., the link between logical variables and
question items is now in an independent import; and is no longer part of either
the logical variables import or the questions import.

Import formats
--------------

CSV formats
~~~~~~~~~~~

Markdown
    In most imports, there is a ``description`` field using Markdown. For more
    information about the Markdown markup language, see: `Daring Fireball
    <http://daringfireball.net/projects/markdown/>`__.

Conventions
    Some fields in the CSV exports are not part of the import. Those fields
    start with ``view_`` ``variables`` and ``datasets``.

    Columns with the ``internal_`` prefix are indended for internal use only
    and will not be imported (e.g. ``internal_comment``).

    Language codes, for all translation purposes: `ISO 639-1
    <http://en.wikipedia.org/wiki/List_of_ISO_639-1_codes>`__

XML formats
~~~~~~~~~~~

Endnote
    Publications in Endnote's XML export.

r2ddi
    DDI-Codebook-based XML, generated by r2ddi.

QeDML
    QeDML-XML from QLIB.

Other formats
~~~~~~~~~~~~~

Endnote keys
    Endnote keys are a special import of two columns (accession number and
    keywords) in addition to the normal XML import. Endnote exports everything
    but the keywords to XML what makes this import neccessary.

Conventions
-----------

-   Name identifiers: all names are set to lower case during import. This means
    that names must be unique despite their capitalization. Furthermore, only a
    limited set of characters is allowed in names: letters (a-z), numbers
    (0-9), dash (-), and underscore (_).

Import structure
----------------

Top level
~~~~~~~~~

::

    import/
    |-- system/       # -> system-wide imports
    |-- study-first/  # \
    |-- study-second/ #  }-> one folder per study
    |-- study-third/  # /

All levels
~~~~~~~~~~

::

    ddionrails/
    |-- study.md
    |-- variables.csv
    |-- ...all other csv files...
    |-- datasets/
    |   |-- version/
    |   |   |-- ...dataset descriptions in DDI-C-XML...
    |-- files/
    |   |-- ...all files for public folder...
    |-- instruments/
    |-- qedml/
    |   |-- ...questionnaires in QeDML-XML-format...
    |-- topics/

Formats
-------

.. toctree::
    :maxdepth: 1

    formats/markdown

CSV Imports
-----------

.. toctree::
    :maxdepth: 1

    csvs/study_md
    csvs/topics_csv
    csvs/concepts_csv
    csvs/periods_csv
    csvs/analysis_units_csv
    csvs/conceptual_datasets_csv
    csvs/datasets_csv
    csvs/variables_csv
    csvs/release_csv
    csvs/datasets_release_csv
    csvs/transformations_csv
    csvs/questionnaires_csv
    csvs/questions_csv
    csvs/answers_csv

